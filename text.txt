query = """
WITH summary_embedding AS (
    SELECT SNOWFLAKE.CORTEX.EMBED_TEXT_1024(
        'snowflake-arctic-embed-l-v2.0',
        ?
    ) AS summary_vec
)
SELECT 
    c.chunk_id,
    c.chunk_text,
    c.filename,
    c.page_number,
    VECTOR_COSINE_SIMILARITY(c.chunk_embedding, s.summary_vec) AS similarity_score
FROM your_chunks_table c
CROSS JOIN summary_embedding s
ORDER BY similarity_score DESC
LIMIT 1
"""

# Execute query with response as parameter
result_df = session.sql(query, params=[response]).to_pandas()
